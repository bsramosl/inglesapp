 {% load static %}
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Login Tailwind</title>
    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400&display=swap" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.js"></script>
      <script src="/static/jQueryInit.js"></script>
    <script src="/static/jquery.blockUI.js"></script>


  </head>
  <body class="bg-gray-100 min-h-screen flex items-center justify-center font-['Roboto']">

    <div class="max-w-6xl w-full bg-white rounded-xl shadow-md overflow-hidden grid grid-cols-1 md:grid-cols-2 p-6">
      <!-- Imagen -->
      <div class="hidden md:flex items-center justify-center">
        <img src="images/undraw_file_sync_ot38.svg" alt="Login image" class="w-80 h-auto" />
      </div>

      <!-- Formulario -->
      <div class="flex items-center justify-center">
        <div class="w-full max-w-md">
          <div class="mb-6">
            <h3 class="text-3xl font-bold text-gray-800 mb-2">Sign In to <span class="text-indigo-600">Colorlib</span></h3>
            <p class="text-gray-500">Lorem ipsum dolor sit amet elit. Sapiente sit aut eos consectetur adipisicing.</p>
          </div>

          <form method="post" class="space-y-4">
              {% csrf_token %}

            <div>
              <label for="username" class="block text-gray-700 font-medium mb-1">Username</label>
              <input type="text" id="username" name="username" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>

            <div>
              <label for="password" class="block text-gray-700 font-medium mb-1">Password</label>
              <input type="password" name="password" id="password" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>

            <div class="flex items-center justify-between">
              <label class="inline-flex items-center text-sm text-gray-600">
                <input type="checkbox" class="form-checkbox text-indigo-600" checked />
                <span class="ml-2">Remember me</span>
              </label>
              <a href="#" class="text-sm text-indigo-500 hover:underline">Forgot Password?</a>
            </div>

            <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 rounded-lg">
              Log In
            </button>

            <div class="text-center text-gray-500 mt-4 text-sm">or sign in with</div>

            <div class="flex justify-center gap-4 mt-2">
              <a href="#" class="text-blue-600 hover:text-blue-800 text-xl">
                <span class="icon-facebook"></span>
              </a>
              <a href="#" class="text-blue-400 hover:text-blue-600 text-xl">
                <span class="icon-twitter"></span>
              </a>
              <a href="#" class="text-red-600 hover:text-red-800 text-xl">
                <span class="icon-google"></span>
              </a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </body>
<script>
    document.querySelector('form').addEventListener('submit', async (e) => {
    e.preventDefault();
    bloqueointerface()
    const formData = new FormData(e.target);

    try {
        const response = await fetch('/login/', {
            method: 'POST',
            body: formData,
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        });

        const data = await response.json();
        $.unblockUI();
        if (data.status === 'success') {
            // Guardar token para otras apps
            localStorage.setItem('multi_app_token', data.token);
            window.location.href = data.url_redirect;
        } else {
           alertaWarning(data.message);
        }
    } catch (error) {
        console.error('Error:', error);
    }
});
</script>
</html>
